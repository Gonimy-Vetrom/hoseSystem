<?xml version="1.0" encoding="utf-8" standalone="no" ?>
<vehicle type="liquidManureHose">
	<annotation>Copyright (C) Wopster, All Rights Reserved.</annotation>
	
    <storeData>
        <name>3M</name>
        <specs>
			<fillTypes>liquidManure</fillTypes>
			<!-- <workingWidth>3</workingWidth> -->
		</specs>	
        <functions>
            <function>$l10n_function_liquidManureHose</function>
        </functions>
        <image>liquidManureHoses/3m/store3m.dds</image><!-- Or just use one for the types (saves room) -->
        <price>150</price>
        <dailyUpkeep>0</dailyUpkeep>
        <lifetime>600</lifetime>
        <rotation>0</rotation>
        <brand>LIZARD</brand>
        <category>slurryTanks</category> <!-- receivingHopper shouldn't be? -->
        <!-- <fieldJob sizeCategory="1" typeCategory="tractor" hasFrontAndBackHydraulics="true" /> -->
        <vertexBufferMemoryUsage>1728608</vertexBufferMemoryUsage>
        <indexBufferMemoryUsage>295512</indexBufferMemoryUsage>
        <textureMemoryUsage>4700088</textureMemoryUsage>
        <instanceVertexBufferMemoryUsage>0</instanceVertexBufferMemoryUsage>
        <instanceIndexBufferMemoryUsage>0</instanceIndexBufferMemoryUsage>
    </storeData>

    <typeDesc>$l10n_typeDesc_liquidManureHose</typeDesc>
    <filename>liquidManureHoses/3m/liquidManureHose3m.i3d</filename>

    <size width="0.2" length="3"/>

    <hoseSystem centerNode="1>0">
        <jointSpline rootJointNode="0>0|0" numJoints="6" />

        <grabPoints>
            <grabPoint node="0>1" componentIndex="0" /> <!-- componentChildNode="0>3" /> -->
            <grabPoint node="2>0" componentIndex="2" /> <!-- componentChildNode="2>1" /> -->
        </grabPoints>
    </hoseSystem>
	
    <hose supportedFillTypeCategories="slurryTank">		
		<attachComponent node="1>0" filename="liquidManureHoses/attachComponent.i3d" />		
		
		<grabPoints>
            <grabPoint node="0>1" componentIndex="0" componentJointIndex="0" /> <!-- componentChildNode="0>3" /> -->
            <grabPoint node="2>0" componentIndex="2" componentJointIndex="1" /> <!-- componentChildNode="2>1" /> -->
		</grabPoints> 	
		
		<!-- <effect fillTypes="liquidManure"> -->
			<!-- <effectNode effectNode="0>2|1" delay="0" materialType="hose" materialTypeId="1" fadeOutTime="0.1" fadeInTime="1" startDelay="0.2" stopDelay="0" /> -->
		<!-- </effect> -->
		
		<emptyingSound node="0>2" file="$data/sounds/manureFillSound.wav" radius="3" innerRadius="2" pitchOffset="0.45" volume="0.6" />
		
        <!-- <targets> -->
            <!-- <target ikChainName="rightArm" target="0>2|0|0" targetOffset="0.05 0.066 0">
                <rotationNode id="1" rotation="90 -30 -20" />
                <rotationNode id="2" rotation="0 0 -44" />
                <rotationNode id="3" rotation="0 0 -10" />

                <rotationNode id="4" rotation="0 0 -60" />
                <rotationNode id="5" rotation="0 0 -110" />
                <rotationNode id="6" rotation="0 0 0" />

                <rotationNode id="7" rotation="0 0 -60" />
                <rotationNode id="8" rotation="0 0 -110" />
                <rotationNode id="9" rotation="0 0 0" />

                <rotationNode id="10" rotation="0 0 -50" />
                <rotationNode id="11" rotation="0 0 -110" />
                <rotationNode id="12" rotation="0 0 0" />

                <rotationNode id="13" rotation="0 0 -40" />
                <rotationNode id="14" rotation="0 0 -100" />
                <rotationNode id="15" rotation="0 0 0" />
            </target> -->
        <!-- </targets> -->

		<joints rootJoint="0>0|0" numJoints="6"/>
		
		<!-- <componentJoints> -->
			<!-- <joints grabPointIndice="1"> -->
				<!-- <joint component1="2" component2="1" index="2>2" transLimit="0 0 0" rotLimit="40 40 0" rotDriveVelocity="0 0 0" maxRotDriveForce="0 0 0" rotLimitSpring="20 20 0" rotLimitDamping="11 11 0"/> -->
				<!-- <joint component1="1" component2="0" index="1>2" transLimit="0 0 0" rotLimit="40 40 0" rotDriveVelocity="0 0 0" maxRotDriveForce="0 0 0" rotLimitSpring="20 20 0" rotLimitDamping="11 11 0"/>  -->
			<!-- </joints> -->
			<!-- <joints grabPointIndice="2"> -->
				<!-- <joint component1="0" component2="1" index="0>4" transLimit="0 0 0" rotLimit="40 40 0" rotDriveVelocity="0 0 0" maxRotDriveForce="0 0 0" rotLimitSpring="20 20 0" rotLimitDamping="11 11 0"/> -->
				<!-- <joint component1="1" component2="2" index="1>1" transLimit="0 0 0" rotLimit="40 40 0" rotDriveVelocity="0 0 0" maxRotDriveForce="0 0 0" rotLimitSpring="20 20 0" rotLimitDamping="11 11 0"/> -->
			<!-- </joints> -->
		<!-- </componentJoints> -->
	</hose>
	
	<designConfigurations>
        <designConfiguration name="$l10n_configuration_nor_liquidManureHose" price="0" icon="$dataS2/menu/hud/configurations/config_edition.png">
            <objectChange node="0>1" connectableActive="false" connectableInactive="false" visibilityActive="true" visibilityInactive="true"/> 
            <objectChange node="0>0|0|1|0" visibilityActive="true" visibilityInactive="false"/> 
        </designConfiguration>
        <designConfiguration name="$l10n_configuration_ext_liquidManureHose" price="25" icon="$dataS2/menu/hud/configurations/config_edition.png">
            <objectChange node="0>1" connectableActive="true" connectableInactive="false" connectableAnimation="connect" visibilityActive="true" visibilityInactive="true"/>
            <objectChange node="0>0|0|1|1" visibilityActive="true" visibilityInactive="false"/> 
        </designConfiguration>
    </designConfigurations>
	
	<!--<baseColorConfigurations useDefaultColors="true" defaultColorIndex="6" price="10" icon="$dataS2/menu/hud/configurations/config_color.png">-->
        <!--<colorNode node="0>0|1" />-->
        <!--<colorNode node="0>0|2" />-->
    <!--</baseColorConfigurations>-->
	
	<animations>
        <animation name="connect">
            <part node="0>0|0|1|1|1"   startTime="0"   endTime="0.5" startRot="0 0 0" endRot="60 0 0"/>
            <part node="0>0|0|1|1|1|0" startTime="0"   endTime="0.5" startRot="0 0 0" endRot="-70 0 0"/>
            <part node="0>0|0|1|1|0"   startTime="0.4" endTime="0.5" startRot="0 0 0" endRot="8 0 0"/>
        </animation>
    </animations>
	
	<!-- LUA: Either force active or set dirt amount self -->
	<washable dirtDuration="30" washDuration="1" workMultiplier="20" />
	
    <components count="3">
        <component1 centerOfMass="0 0 0.25" solverIterationCount="40" />
        <component2 centerOfMass="0 0 0" solverIterationCount="40" />
        <component3 centerOfMass="0 0 -0.25" solverIterationCount="40" />
		<!-- We need to toggle the component joints on grab the hose is not reacting  -->
		<joint component1="0" component2="1" index="0>4" transLimit="0 0 0" rotLimit="40 40 0" rotDriveVelocity="0 0 0" maxRotDriveForce="0 0 0" rotLimitSpring="20 20 0" rotLimitDamping="11 11 0"/>
		<joint component1="1" component2="2" index="1>1" transLimit="0 0 0" rotLimit="40 40 0" rotDriveVelocity="0 0 0" maxRotDriveForce="0 0 0" rotLimitSpring="20 20 0" rotLimitDamping="11 11 0"/> 
		<!-- <collisionPair component1="0" component2="1" enabled="false" /> -->
		<!-- <collisionPair component1="0" component2="2" enabled="false" /> -->
	</components>

    <schemaOverlay file="$dataS2/menu/schemas/implementSchema.png" fileSelected="$dataS2/menu/schemas/implementSchemaSelected.png" width="0.5" height="0.5" attacherJointPosition="0 0"/>
</vehicle>


<!-- 
	------ Build structure of hose ------
	All joints must have its Z axis forward
	Component 1 need its pivot at start
	Component "end" need its pivot at end
	Movable "nodes" (not skinned node) must be placed as sub of the IK joint (attacherJoints need to be confirmed working here!)
-->